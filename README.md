# sport-news-bot (PROSPORT)

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –≤ Telegram.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ü–∞—Ä—Å–∏–Ω–≥**: –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π —Å Championat.com (Selenium)
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è**: NLP-–æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ spaCy + pymorphy3, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–∏–∞—Å–∞–º–∏
- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è**: –£–º–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –≤ "–∏—Å—Ç–æ—Ä–∏–∏"
- **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è**: Fingerprinting + –∞–Ω—Ç–∏–¥—É–±–ª–∏–∫–∞—Ç—ã (Jaccard similarity)
- **–ü—É–±–ª–∏–∫–∞—Ü–∏—è**: Telegram-–±–æ—Ç —Å rate limiting, —Ç–∏—Ö–∏–µ —á–∞—Å—ã, –æ—á–µ—Ä–µ–¥—å
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫, –∞–ª–µ—Ä—Ç—ã, –¥–∞–π–¥–∂–µ—Å—Ç—ã

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/VladPatr96/sport-bot.git
cd sport-bot

# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª –∏–∑ —à–∞–±–ª–æ–Ω–∞
cp .env.example .env

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
nano .env  # –£–∫–∞–∂–∏ TG_BOT_TOKEN –∏ TG_CHANNEL_ID
```

### 2. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ + –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose ps

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs -f bot
docker-compose logs -f webapp
```

### 3. –î–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

–û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:8000

### 4. –ü–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ—Å—Ç–µ–π (–≤—Ä—É—á–Ω—É—é)

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–µ—Ä –æ–¥–∏–Ω —Ä–∞–∑
docker-compose run --rm parser

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é
docker-compose run --rm parser python cluster/build.py
```

### 5. –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose down

# –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ volumes
docker-compose down -v
```

## üõ†Ô∏è –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–±–µ–∑ Docker)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv .venv
.venv\Scripts\activate  # Windows
source .venv/bin/activate  # Linux/Mac

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt
pip install -r requirements-dev.txt  # –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

# –ó–∞–≥—Ä—É–∑–∏—Ç—å spaCy –º–æ–¥–µ–ª–∏
python -m spacy download ru_core_news_sm
python -m spacy download en_core_web_sm
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å .env.example ‚Üí .env
cp .env.example .env

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
python scripts/db_migrate.py

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç –ë–î
python db/gen_manifest.py database/prosport.db
```

### 3. –ó–∞–ø—É—Å–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```bash
# –ü–∞—Ä—Å–µ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π
python scripts/sync_champ_news.py

# –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
python cluster/build.py

# Telegram-–±–æ—Ç (–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫)
python bot/scheduler.py --loop

# –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python scripts/run_webapp_bot.py --port 8000

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
python scripts/monitor.py --loop
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

```bash
# –õ–∏–Ω—Ç–µ—Ä (–∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
ruff check . --fix

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
mypy src

# –¢–µ—Å—Ç—ã
pytest -q

# –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ä–∞–∑—É
ruff . && mypy src && pytest -q
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
sport-news-bot/
‚îú‚îÄ‚îÄ bot/                  # Telegram-–±–æ—Ç, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îú‚îÄ‚îÄ categorizer/          # NLP –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è, –∞–ª–∏–∞—Å—ã, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–≥–æ–≤
‚îú‚îÄ‚îÄ cluster/              # –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π, fingerprinting, –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ webapp/               # FastAPI –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –¥–∞–π–¥–∂–µ—Å—Ç—ã, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
‚îú‚îÄ‚îÄ parsers/              # –ü–∞—Ä—Å–µ—Ä—ã –Ω–æ–≤–æ—Å—Ç–µ–π (Championat + —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö)
‚îú‚îÄ‚îÄ scripts/              # –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –º–∏–≥—Ä–∞—Ü–∏–∏, backfill)
‚îú‚îÄ‚îÄ db/                   # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î, —É—Ç–∏–ª–∏—Ç—ã, manifest.json
‚îú‚îÄ‚îÄ src/prosport/         # Core API-—Å–ª–æ–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚îú‚îÄ‚îÄ mappings/             # YAML-—Å–ª–æ–≤–∞—Ä–∏ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö –∞–ª–∏–∞—Å–æ–≤
‚îú‚îÄ‚îÄ docs/                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ tests/                # –¢–µ—Å—Ç—ã (pytest)
‚îú‚îÄ‚îÄ database/             # SQLite –ë–î (–Ω–µ –≤ git, –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ Docker)
‚îú‚îÄ‚îÄ Dockerfile            # Docker –æ–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-compose.yml    # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
‚îî‚îÄ‚îÄ .env.example          # –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–±–µ–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤)
```

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**SQLite** —Å 18 —Ç–∞–±–ª–∏—Ü–∞–º–∏:

- **–°—É—â–Ω–æ—Å—Ç–∏**: sports, tournaments, teams, athletes
- **–ù–æ–≤–æ—Å—Ç–∏**: news, tags, news_article_tags (M2M)
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è**: entity_aliases, news_entity_assignments
- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è**: stories, story_articles, content_fingerprints
- **–ü—É–±–ª–∏–∫–∞—Ü–∏—è**: publish_queue, publish_map, publish_edits
- **–î–∞–π–¥–∂–µ—Å—Ç—ã**: digests, digest_items
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: monitor_logs

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π: `python scripts/db_migrate.py`

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ—Å—Ç–µ–π –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏
python scripts/fetch_entity_news_on_demand.py --entity-id 123 --entity-type team

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–π–¥–∂–µ—Å—Ç–∞
python scripts/digest.py --limit 25

# –û–±–æ–≥–∞—â–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π –∞–ª–∏–∞—Å–∞–º–∏
python scripts/alias_backfill.py

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è fingerprints –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π
python scripts/backfill_fingerprints.py

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏—Å—Ç–æ—Ä–∏–π
python cluster/refresh_titles.py
```

## üê≥ Docker –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
docker-compose build

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker-compose up webapp

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–ø—Ä–æ—Ñ–∏–ª—å)
docker-compose --profile monitoring up

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f bot --tail=100

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose exec bot python scripts/monitor.py

# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã + volumes + –æ–±—Ä–∞–∑—ã)
docker-compose down -v --rmi all
```

## üìù CI/CD

GitHub Actions workflow [.github/workflows/project-health.yml](.github/workflows/project-health.yml):

- ‚úÖ Ruff lint
- ‚úÖ MyPy type checking
- ‚úÖ Pytest tests
- üì¶ Artifacts: `db/manifest.json`, `docs/PROMPT_AI.md`, `docs/TASKS_AI.md`

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [CHANGELOG.md](docs/CHANGELOG.md) ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ROADMAP.md](docs/ROADMAP.md) ‚Äî –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è
- [DB_SCHEMA.md](docs/DB_SCHEMA.md) ‚Äî —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [PROJECT_TREE.md](docs/PROJECT_TREE.md) ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π –≤–µ—Ç–∫—É: `git checkout -b feature/amazing-feature`
3. –ó–∞–∫–æ–º–º–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è: `git commit -m 'feat: add amazing feature'`
4. –ó–∞–ø—É—à –≤ –≤–µ—Ç–∫—É: `git push origin feature/amazing-feature`
5. –°–æ–∑–¥–∞–π Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç–Ω—ã–º. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
