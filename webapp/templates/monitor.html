{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0">Monitor</h1>
    <div class="text-muted small">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫</div>
</div>

{% if metrics %}
<div class="table-responsive">
    <table class="table table-hover align-middle">
        <thead>
            <tr>
                <th>–ú–µ—Ç—Ä–∏–∫–∞</th>
                <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                <th>–ü–æ—Ä–æ–≥</th>
                <th>–û–∫–Ω–æ</th>
                <th>–ú–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
            </tr>
        </thead>
        <tbody>
        {% for entry in metrics %}
            {% set status = entry.status %}
            {% set badge = 'üü¢' %}
            {% if status == 'alert' %}
                {% set badge = 'üî¥' %}
            {% elif status == 'unknown' %}
                {% set badge = '‚ö™' %}
            {% endif %}
            <tr>
                <td><code>{{ entry.metric }}</code></td>
                <td>
                    {% if entry.value is not none %}
                        {{ '%0.0f'|format(entry.value) if entry.value|round(0) == entry.value else '%0.2f'|format(entry.value) }}
                    {% else %}
                        ‚Äî
                    {% endif %}
                </td>
                <td>
                    {% if entry.threshold is not none %}
                        {{ entry.threshold|round(0)|int if entry.threshold|round(0) == entry.threshold else entry.threshold }}
                        {% if entry.mode == 'min' %}
                            (min)
                        {% elif entry.mode == 'max' %}
                            (max)
                        {% endif %}
                    {% else %}
                        ‚Äî
                    {% endif %}
                </td>
                <td class="text-muted small">
                    {{ entry.meta.window or '‚Äî' }}
                </td>
                <td class="text-muted small">{{ entry.ts_utc }}</td>
                <td>{{ badge }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<p class="text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–±–æ—Ä—â–∏–∫ monitor.</p>
{% endif %}
{% endblock %}
